<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>bayesplot</title>
  <meta name="description" content="bayesplot">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="bayesplot" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://mc-stan.org/bayesplot/index.html" />
  <meta property="og:image" content="https://mc-stan.org/bayesplot/index.htmlimages/logo.png" />
  
  <meta name="github-repo" content="stan-dev/bayesplot" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="bayesplot" />
  
  
  <meta name="twitter:image" content="https://mc-stan.org/bayesplot/index.htmlimages/logo.png" />

<meta name="author" content="Stan Development Team">


<meta name="date" content="2017-05-25">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="images/logo-icon.png" type="image/x-icon">
<link rel="prev" href="plotting-mcmc-draws.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>bayesplot Vignettes</a></li>
<li class="chapter" data-level="1" data-path="installing-and-loading-the-bayesplot-package.html"><a href="installing-and-loading-the-bayesplot-package.html"><i class="fa fa-check"></i><b>1</b> Installing and loading the bayesplot package</a><ul>
<li class="chapter" data-level="1.1" data-path="installing-and-loading-the-bayesplot-package.html"><a href="installing-and-loading-the-bayesplot-package.html#installation"><i class="fa fa-check"></i><b>1.1</b> Installation</a></li>
<li class="chapter" data-level="1.2" data-path="installing-and-loading-the-bayesplot-package.html"><a href="installing-and-loading-the-bayesplot-package.html#loading-the-package"><i class="fa fa-check"></i><b>1.2</b> Loading the package</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="posterior-predictive-checking.html"><a href="posterior-predictive-checking.html"><i class="fa fa-check"></i><b>2</b> Posterior Predictive Checking</a><ul>
<li class="chapter" data-level="2.0.1" data-path="posterior-predictive-checking.html"><a href="posterior-predictive-checking.html#posterior-predictive-distribution"><i class="fa fa-check"></i><b>2.0.1</b> Posterior predictive distribution</a></li>
<li class="chapter" data-level="2.0.2" data-path="posterior-predictive-checking.html"><a href="posterior-predictive-checking.html#graphical-posterior-predictive-checks"><i class="fa fa-check"></i><b>2.0.2</b> Graphical posterior predictive checks</a></li>
<li class="chapter" data-level="2.1" data-path="posterior-predictive-checking.html"><a href="posterior-predictive-checking.html#fitting-some-example-models"><i class="fa fa-check"></i><b>2.1</b> Fitting some example models</a></li>
<li class="chapter" data-level="2.2" data-path="posterior-predictive-checking.html"><a href="posterior-predictive-checking.html#histograms-and-density-estimates"><i class="fa fa-check"></i><b>2.2</b> Histograms and density estimates</a></li>
<li class="chapter" data-level="2.3" data-path="posterior-predictive-checking.html"><a href="posterior-predictive-checking.html#distributions-of-test-statistics"><i class="fa fa-check"></i><b>2.3</b> Distributions of test statistics</a></li>
<li class="chapter" data-level="2.4" data-path="posterior-predictive-checking.html"><a href="posterior-predictive-checking.html#other-ppcs-and-ppcs-by-group"><i class="fa fa-check"></i><b>2.4</b> Other PPCs and PPCs by group</a></li>
<li class="chapter" data-level="2.5" data-path="posterior-predictive-checking.html"><a href="posterior-predictive-checking.html#providing-an-interface-to-bayesplot-ppcs-from-another-package"><i class="fa fa-check"></i><b>2.5</b> Providing an interface to bayesplot PPCs from another package</a><ul>
<li class="chapter" data-level="2.5.1" data-path="posterior-predictive-checking.html"><a href="posterior-predictive-checking.html#defining-a-pp_check-method"><i class="fa fa-check"></i><b>2.5.1</b> Defining a <code>pp_check</code> method</a></li>
<li class="chapter" data-level="2.5.2" data-path="posterior-predictive-checking.html"><a href="posterior-predictive-checking.html#examples-of-pp_check-methods-in-other-packages"><i class="fa fa-check"></i><b>2.5.2</b> Examples of <code>pp_check</code> methods in other packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="plotting-mcmc-draws.html"><a href="plotting-mcmc-draws.html"><i class="fa fa-check"></i><b>3</b> Plotting MCMC Draws</a><ul>
<li class="chapter" data-level="3.1" data-path="plotting-mcmc-draws.html"><a href="plotting-mcmc-draws.html#fitting-an-example-model"><i class="fa fa-check"></i><b>3.1</b> Fitting an example model</a></li>
<li class="chapter" data-level="3.2" data-path="plotting-mcmc-draws.html"><a href="plotting-mcmc-draws.html#interval-estimates"><i class="fa fa-check"></i><b>3.2</b> Interval estimates</a></li>
<li class="chapter" data-level="3.3" data-path="plotting-mcmc-draws.html"><a href="plotting-mcmc-draws.html#histograms-and-density-estimates-1"><i class="fa fa-check"></i><b>3.3</b> Histograms and density estimates</a></li>
<li class="chapter" data-level="3.4" data-path="plotting-mcmc-draws.html"><a href="plotting-mcmc-draws.html#scatterplots"><i class="fa fa-check"></i><b>3.4</b> Scatterplots</a></li>
<li class="chapter" data-level="3.5" data-path="plotting-mcmc-draws.html"><a href="plotting-mcmc-draws.html#traceplots"><i class="fa fa-check"></i><b>3.5</b> Traceplots</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html"><i class="fa fa-check"></i><b>4</b> MCMC Diagnostics</a><ul>
<li class="chapter" data-level="4.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#general-mcmc-diagnostics"><i class="fa fa-check"></i><b>4.1</b> General MCMC diagnostics</a><ul>
<li class="chapter" data-level="4.1.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#rhat-potential-scale-reduction-statistic"><i class="fa fa-check"></i><b>4.1.1</b> Rhat: potential scale reduction statistic</a></li>
<li class="chapter" data-level="4.1.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#effective-sample-size"><i class="fa fa-check"></i><b>4.1.2</b> Effective sample size</a></li>
<li class="chapter" data-level="4.1.3" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#autocorrelation"><i class="fa fa-check"></i><b>4.1.3</b> Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#diagnostics-for-the-no-u-turn-sampler"><i class="fa fa-check"></i><b>4.2</b> Diagnostics for the No-U-Turn Sampler</a><ul>
<li class="chapter" data-level="4.2.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#divergent-transitions"><i class="fa fa-check"></i><b>4.2.1</b> Divergent transitions</a></li>
<li class="chapter" data-level="4.2.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#energy-and-bayesian-fraction-of-missing-information"><i class="fa fa-check"></i><b>4.2.2</b> Energy and Bayesian fraction of missing information</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>5</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">bayesplot</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mcmc-diagnostics" class="section level1">
<h1><span class="header-section-number">4</span> MCMC Diagnostics</h1>
<p>This vignette focuses on MCMC diagnostic plots. Plots of parameter estimates from MCMC draws are covered in the separate vignette <a href="MCMC.html">Plotting MCMC draws using the bayesplot package</a>, and graphical posterior predictive checks are covered in <a href="PPC.html">Graphical posterior predictive checks using the bayesplot package</a>.</p>
<p>In addition to <strong>bayesplot</strong> we’ll load the following packages:</p>
<ul>
<li><strong>ggplot2</strong> for customizing the ggplot objects created by <strong>bayesplot</strong></li>
<li><strong>rstan</strong> for fitting the example models used throughout the vignette</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;bayesplot&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;ggplot2&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;rstan&quot;</span>)      </code></pre></div>
<div id="general-mcmc-diagnostics" class="section level2">
<h2><span class="header-section-number">4.1</span> General MCMC diagnostics</h2>
<p>A Markov chain generates draws from the target distribution only after it has converged to equilibrium. Unfortunately, this is only guaranteed in the limit in theory. In practice, diagnostics must be applied to monitor whether the Markov chain(s) have converged. The <strong>bayesplot</strong> package provides various plotting functions for visualizing Markov chain Monte Carlo (MCMC) diagnostics after fitting a Bayesian model. MCMC draws from any package can be used with <strong>bayesplot</strong>, although there are a few diagnostic plots that are specifically intended to be used for <a href="http://mc-stan.org/">Stan</a> models.</p>
<p>To demonstrate, in this vignette we’ll use the eight schools example discussed in Rubin (1981), Gelman et al (2013), and the <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan">RStan Getting Started</a> wiki. This is a simple hierarchical meta-analysis model with data consisting of point estimates <code>y</code> and standard errors <code>sigma</code> from analyses of test prep programs in <code>J=8</code> schools:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">schools_dat &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">J =</span> <span class="dv">8</span>,
  <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">28</span>,  <span class="dv">8</span>, -<span class="dv">3</span>,  <span class="dv">7</span>, -<span class="dv">1</span>,  <span class="dv">1</span>, <span class="dv">18</span>, <span class="dv">12</span>),
  <span class="dt">sigma =</span> <span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">10</span>, <span class="dv">16</span>, <span class="dv">11</span>,  <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">10</span>, <span class="dv">18</span>)
)</code></pre></div>
The model is:
<span class="math display">\[\begin{align*}
y_j &amp;\sim {\rm Normal}(\theta_j, \sigma_j), \quad j = 1,\dots,J \\
\theta_j &amp;\sim {\rm Normal}(\mu, \tau), \quad j = 1, \dots, J \\
\mu &amp;\sim {\rm Normal}(0, 10) \\
\tau &amp;\sim {\rm half-Cauchy}(0, 10),
\end{align*}\]</span>
<p>with the normal distribution parameterized by the mean and standard deviation, not the variance or precision. In Stan code:</p>
<pre class="stan"><code>// Saved in &#39;schools_mod1.stan&#39;
data {
  int&lt;lower=0&gt; J;
  vector[J] y;
  vector&lt;lower=0&gt;[J] sigma;
}
parameters {
  real mu;
  real&lt;lower=0&gt; tau;
  vector[J] theta;
}
model {
  mu ~ normal(0, 10);
  tau ~ cauchy(0, 10);
  theta ~ normal(mu, tau);
  y ~ normal(theta, sigma);
}</code></pre>
<p>This parameterization of the model is referred to as the centered parameterization (CP). We’ll also fit the same statistical model but using the so-called non-centered parameterization (NCP), which replaces the vector <span class="math inline">\(\theta\)</span> with a vector <span class="math inline">\(\eta\)</span> of a priori <em>i.i.d.</em> standard normal parameters and then contructs <span class="math inline">\(\theta\)</span> deterministically from <span class="math inline">\(\eta\)</span> by scaling by <span class="math inline">\(\tau\)</span> and shifting by <span class="math inline">\(\mu\)</span>:</p>
<span class="math display">\[\begin{align*}
\theta_j &amp;= \mu + \tau \,\eta_j, \quad j = 1,\dots,J \\
\eta_j &amp;\sim N(0,1), \quad j = 1,\dots,J.
\end{align*}\]</span>
<p>The Stan code for this model is:</p>
<pre class="stan"><code>// Saved in &#39;schools_mod2.stan&#39;
data {
  int&lt;lower=0&gt; J;
  vector[J] y;
  vector&lt;lower=0&gt;[J] sigma;
}
parameters {
  real mu;
  real&lt;lower=0&gt; tau;
  vector[J] eta;
}
transformed parameters {
  vector[J] theta;
  theta = mu + tau * eta;
}
model {
  mu ~ normal(0, 10);
  tau ~ cauchy(0, 10);
  eta ~ normal(0, 1); // implies theta ~ normal(mu, tau)
  y ~ normal(theta, sigma);
}</code></pre>
<p>The centered and non-centered are two parameterizations of the same statistical model, but they have very different practical implications for MCMC. Using the <strong>bayesplot</strong> diagnostic plots, we’ll see that, for this data, the NCP is required in order to properly explore the posterior distribution.</p>
<p>To fit both models we first translate the Stan code to C++ and compile it using the <code>stan_model</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">schools_mod1 &lt;-<span class="st"> </span><span class="kw">stan_model</span>(<span class="st">&quot;schools_mod1.stan&quot;</span>)
schools_mod2 &lt;-<span class="st"> </span><span class="kw">stan_model</span>(<span class="st">&quot;schools_mod2.stan&quot;</span>)</code></pre></div>
<p>We then fit the model by calling Stan’s MCMC algorithm using the <code>sampling</code> function,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit1 &lt;-<span class="st"> </span><span class="kw">sampling</span>(schools_mod1, <span class="dt">data =</span> schools_dat)</code></pre></div>
<pre><code>## Warning: There were 32 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
## http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code>## Warning: There were 1 chains where the estimated Bayesian Fraction of Missing Information was low. See
## http://mc-stan.org/misc/warnings.html#bfmi-low</code></pre>
<pre><code>## Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit2 &lt;-<span class="st"> </span><span class="kw">sampling</span>(schools_mod2, <span class="dt">data =</span> schools_dat)</code></pre></div>
<pre><code>## Warning: There were 6 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
## http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup

## Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
<p>and extract a <code>iterations x chains x parameters</code> array of posterior draws with <code>as.array</code>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extract posterior draws for later use</span>
posterior1 &lt;-<span class="st"> </span><span class="kw">as.array</span>(fit1)
posterior2 &lt;-<span class="st"> </span><span class="kw">as.array</span>(fit2)</code></pre></div>
<p>For now ignore any warnings about divergent transitions after warmup. We will come back to those later in the vignette in the <a href="#diagnostics-for-the%20no-u-turn-sampler">Diagnostics for the No-U-Turn Sampler</a> section.</p>
<div id="rhat-potential-scale-reduction-statistic" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Rhat: potential scale reduction statistic</h3>
<blockquote>
<p>One way to monitor whether a chain has converged to the equilibrium distribution is to compare its behavior to other randomly initialized chains. This is the motivation for the Gelman and Rubin (1992) potential scale reduction statistic, <span class="math inline">\(\hat{R}\)</span>. The <span class="math inline">\(\hat{R}\)</span> statistic measures the ratio of the average variance of samples within each chain to the variance of the pooled samples across chains; if all chains are at equilibrium, these will be the same and <span class="math inline">\(\hat{R}\)</span> will be one. If the chains have not converged to a common distribution, the <span class="math inline">\(\hat{R}\)</span> statistic will be greater than one. (Stan Development Team, 2016).</p>
</blockquote>
<p>The <strong>bayesplot</strong> package provides the functions <code>mcmc_rhat</code> and <code>mcmc_rhat_hist</code> for visualizing <span class="math inline">\(\hat{R}\)</span> estimates.</p>
<p>First we’ll quickly fit one of the models above again, this time intentionally using too few MCMC iterations. This should lead to some high <span class="math inline">\(\hat{R}\)</span> values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit1_50iter &lt;-<span class="st"> </span><span class="kw">sampling</span>(schools_mod1, <span class="dt">data =</span> schools_dat, <span class="dt">chains =</span> <span class="dv">2</span>, <span class="dt">iter =</span> <span class="dv">50</span>)</code></pre></div>
<p><strong>bayesplot</strong> also provides a generic <code>rhat</code> extractor function, currently with methods defined for models fit using the <strong>rstan</strong> and <strong>rstanarm</strong> packages. But regardless of how you fit your model, all <strong>bayesplot</strong> needs is a vector of <span class="math inline">\(\hat{R}\)</span> values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;bayesplot&quot;</span>)
rhats &lt;-<span class="st"> </span><span class="kw">rhat</span>(fit1_50iter)
<span class="kw">print</span>(rhats)</code></pre></div>
<pre><code>##       mu      tau theta[1] theta[2] theta[3] theta[4] theta[5] theta[6] 
## 1.248039 1.156433 1.220262 1.071397 1.071692 1.144008 1.139419 1.098858 
## theta[7] theta[8]     lp__ 
## 1.000822 1.034728 1.352122</code></pre>
<p>We can visualize the <span class="math inline">\(\hat{R}\)</span> values with the <code>mcmc_rhat</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">color_scheme_set</span>(<span class="st">&quot;brightblue&quot;</span>) <span class="co"># see help(&quot;color_scheme_set&quot;)</span>
<span class="kw">mcmc_rhat</span>(rhats)</code></pre></div>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<p><img src="bayesplot_files/figure-html/mcmc_rhat-1.png" width="672" /></p>
<p>In the plot, the points representing the <span class="math inline">\(\hat{R}\)</span> values are colored based on whether they are less than <span class="math inline">\(1.05\)</span>, between <span class="math inline">\(1.05\)</span> and <span class="math inline">\(1.1\)</span>, or greater than <span class="math inline">\(1.1\)</span>.</p>
<p>We can see the names of the parameters with the concerning <span class="math inline">\(\hat{R}\)</span> values by turning on the <span class="math inline">\(y\)</span>-axis text using the <code>yaxis_text</code> convenience function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_rhat</span>(rhats) +<span class="st"> </span><span class="kw">yaxis_text</span>()</code></pre></div>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<p><img src="bayesplot_files/figure-html/mcmc_rhat-2-1.png" width="672" /></p>
<p>The axis <span class="math inline">\(y\)</span>-axis text is off by default for this plot because it’s only possible to see the labels clearly for models with very few parameters.</p>
<p>If we look at the same model fit using longer Markov chains we should see all <span class="math inline">\(\hat{R} &lt; 1.1\)</span>, and all points in the plot the same (light) color:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_rhat</span>(<span class="dt">rhat =</span> <span class="kw">rhat</span>(fit1)) +<span class="st"> </span><span class="kw">yaxis_text</span>()</code></pre></div>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<p><img src="bayesplot_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>We can see the same information shown by <code>mcmc_rhat</code> but in histogram form using the <code>mcmc_rhat_hist</code> function. See the <strong>Examples</strong> section in <code>help(&quot;mcmc_rhat_hist&quot;)</code> for examples.</p>
</div>
<div id="effective-sample-size" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Effective sample size</h3>
<p>The effective sample size is an estimate of the number of independent draws from the posterior distribution of the estimand of interest. Because the draws within a Markov chain are <em>not</em> independent if there is autocorrelation, the effective sample size, <span class="math inline">\(n_{eff}\)</span>, will be smaller than the total sample size, <span class="math inline">\(N\)</span>. The larger the ratio of <span class="math inline">\(n_{eff}\)</span> to <span class="math inline">\(N\)</span> the better.</p>
<p>The <strong>bayesplot</strong> package provides a generic <code>neff_ratio</code> extractor function, currently with methods defined for models fit using the <strong>rstan</strong> and <strong>rstanarm</strong> packages. But regardless of how you fit your model, all <strong>bayesplot</strong> needs is a vector of <span class="math inline">\(n_{eff}/N\)</span> values. The <code>mcmc_neff</code> and <code>mcmc_neff_hist</code> can then be used to plot the ratios.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ratios1 &lt;-<span class="st"> </span><span class="kw">neff_ratio</span>(fit1)
<span class="kw">print</span>(ratios1)</code></pre></div>
<pre><code>##         mu        tau   theta[1]   theta[2]   theta[3]   theta[4] 
## 0.14584315 0.10942038 0.23084294 0.22386398 0.29200236 0.28808404 
##   theta[5]   theta[6]   theta[7]   theta[8]       lp__ 
## 0.25090377 0.26807579 0.22602438 0.35102491 0.06546018</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_neff</span>(ratios1)</code></pre></div>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<p><img src="bayesplot_files/figure-html/print-neff-ratios-1.png" width="672" /></p>
<p>In the plot, the points representing the values of <span class="math inline">\(n_{eff}/N\)</span> are colored based on whether they are less than <span class="math inline">\(0.1\)</span>, between <span class="math inline">\(0.1\)</span> and <span class="math inline">\(0.5\)</span>, or greater than <span class="math inline">\(0.5\)</span>. These particular values are arbitrary in that they have no particular theoretical meaning, but a useful heuristic is to worry about any <span class="math inline">\(n_{eff}/N\)</span> less than <span class="math inline">\(0.1\)</span>.</p>
<p>One important thing to keep in mind is that these ratios will depend not only on the model being fit but also on the particular MCMC algorithm used. One reason why we have such high ratios of <span class="math inline">\(n_{eff}\)</span> to <span class="math inline">\(N\)</span> is that the No-U-Turn sampler used by <strong>rstan</strong> generally produces draws from the posterior distribution with much lower autocorrelations compared to draws obtained using other MCMC algorithms (e.g., Gibbs).</p>
<p>Even for models fit using <strong>rstan</strong> the parameterization can make a big difference. Here are the <span class="math inline">\(n_{eff}/N\)</span> plots for <code>fit1</code> and <code>fit2</code> side by side.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A function we&#39;ll use several times to plot comparisons of the centered</span>
<span class="co"># parameterization (cp) and the non-centered parameterization (ncp). See</span>
<span class="co"># help(&quot;bayesplot_grid&quot;) for details on the bayesplot_grid function used here.</span>
compare_cp_ncp &lt;-<span class="st"> </span>function(cp_plot, ncp_plot, <span class="dt">ncol =</span> <span class="dv">1</span>) {
  txt &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Centered parameterization&quot;</span>, <span class="st">&quot;Non-centered parameterization&quot;</span>)
  <span class="kw">bayesplot_grid</span>(cp_plot, ncp_plot, <span class="dt">subtitles =</span> txt,
                 <span class="dt">grid_args =</span> <span class="kw">list</span>(<span class="dt">ncol =</span> ncol))
}

neff1 &lt;-<span class="st"> </span><span class="kw">neff_ratio</span>(fit1, <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;theta&quot;</span>, <span class="st">&quot;mu&quot;</span>, <span class="st">&quot;tau&quot;</span>))
neff2 &lt;-<span class="st"> </span><span class="kw">neff_ratio</span>(fit2, <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;theta&quot;</span>, <span class="st">&quot;mu&quot;</span>, <span class="st">&quot;tau&quot;</span>))
<span class="kw">compare_cp_ncp</span>(<span class="kw">mcmc_neff</span>(neff1), <span class="kw">mcmc_neff</span>(neff2))</code></pre></div>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<p><img src="bayesplot_files/figure-html/mcmc_neff-compare-1.png" width="672" /></p>
<p>Because of the difference in parameterization, the effective sample sizes are much better for the second model, the non-centered parameterization.</p>
</div>
<div id="autocorrelation" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Autocorrelation</h3>
<p>As mentioned above, <span class="math inline">\(n_{eff}/N\)</span> decreases as autocorrelation becomes more extreme. We can visualize the autocorrelation using the <code>mcmc_acf</code> (line plot) or <code>mcmc_acf_bar</code> (bar plot) functions. For the selected parameters, these functions show the autocorrelation for each Markov chain separately up to a user-specified number of lags.</p>
<p>Here we can again see a difference when comparing the two parameterizations of the same model. For model 1, <span class="math inline">\(\theta_1\)</span> is the primitive parameter for school 1, whereas for the non-centered parameterization in model 2 the primitive parameter is <span class="math inline">\(\eta_1\)</span> (and <span class="math inline">\(\theta_1\)</span> is later constructed from <span class="math inline">\(\eta_1\)</span>, <span class="math inline">\(\mu\)</span>, and <span class="math inline">\(\tau\)</span>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">compare_cp_ncp</span>(
  <span class="kw">mcmc_acf</span>(posterior1, <span class="dt">pars =</span> <span class="st">&quot;theta[1]&quot;</span>, <span class="dt">lags =</span> <span class="dv">10</span>),
  <span class="kw">mcmc_acf</span>(posterior2, <span class="dt">pars =</span> <span class="st">&quot;eta[1]&quot;</span>, <span class="dt">lags =</span> <span class="dv">10</span>),
  <span class="dt">ncol =</span> <span class="dv">2</span>
)</code></pre></div>
<p><img src="bayesplot_files/figure-html/mcmc_acf-1.png" width="672" /></p>
</div>
</div>
<div id="diagnostics-for-the-no-u-turn-sampler" class="section level2">
<h2><span class="header-section-number">4.2</span> Diagnostics for the No-U-Turn Sampler</h2>
<p>The No-U-Turn Sampler (NUTS, Hoffman and Gelman, 2014) is the variant of Hamiltonian Monte Carlo (HMC) used by <a href="http://mc-stan.org/">Stan</a> and the various R packages that depend on Stan for fitting Bayesian models.</p>
<p>The <strong>bayesplot</strong> package has special functions for visualizing some of the unique diagnostics permitted by HMC, and NUTS in particular. See Betancourt (2017), Betancourt and Girolami (2013), and Stan Development Team (2016) for more details on the concepts.</p>
<p>The special <strong>bayesplot</strong> functions for NUTS diagnostics are</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">available_mcmc</span>(<span class="dt">pattern =</span> <span class="st">&quot;_nuts_&quot;</span>)</code></pre></div>
<pre><code>## bayesplot MCMC module:
## (matching pattern &#39;_nuts_&#39;) 
##   mcmc_nuts_acceptance
##   mcmc_nuts_divergence
##   mcmc_nuts_energy
##   mcmc_nuts_stepsize
##   mcmc_nuts_treedepth</code></pre>
<p>The <strong>bayesplot</strong> package also provides generic functions <code>log_posterior</code> and <code>nuts_params</code> for extracting the required information for the plots from fitted model objects. Currently methods are provided for models fit using the <strong>rstan</strong> and <strong>rstanarm</strong> packages, although it is not difficult to define additional methods for the objects returned by other R packages.</p>
<p>For the Stan models we fit above we can use the <code>log_posterior</code> and <code>nuts_params</code> methods for stanfit objects:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lp1 &lt;-<span class="st"> </span><span class="kw">log_posterior</span>(fit1)
<span class="kw">head</span>(lp1)</code></pre></div>
<pre><code>##   Iteration     Value Chain
## 1         1 -6.608457     1
## 2         2 -5.208226     1
## 3         3 -5.208226     1
## 4         4 -5.208226     1
## 5         5 -5.943551     1
## 6         6 -5.943551     1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">np1 &lt;-<span class="st"> </span><span class="kw">nuts_params</span>(fit1)
<span class="kw">head</span>(np1)</code></pre></div>
<pre><code>##   Iteration     Parameter     Value Chain
## 1         1 accept_stat__ 0.1949891     1
## 2         2 accept_stat__ 0.5017767     1
## 3         3 accept_stat__ 0.3077782     1
## 4         4 accept_stat__ 0.2858313     1
## 5         5 accept_stat__ 0.4225576     1
## 6         6 accept_stat__ 0.2555739     1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># for the second model</span>
lp2 &lt;-<span class="st"> </span><span class="kw">log_posterior</span>(fit2)
np2 &lt;-<span class="st"> </span><span class="kw">nuts_params</span>(fit2)</code></pre></div>
<div id="divergent-transitions" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Divergent transitions</h3>
<p>When running the Stan models at the beginning of this vignette there were warnings about divergent transitions. For an explanation of these warnings see <a href="http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup">Divergent transitions after warmup</a>.</p>
<p>The <code>divergences</code> argument to the <code>mcmc_trace</code> function can be used to add a rug plot (in red) of the divergences to a trace plot of parameter draws. Typically we can see that at least one of the chains is getting stuck wherever there is a cluster of many red marks:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">color_scheme_set</span>(<span class="st">&quot;mix-brightblue-gray&quot;</span>)
<span class="kw">mcmc_trace</span>(posterior1, <span class="dt">pars =</span> <span class="st">&quot;tau&quot;</span>, <span class="dt">divergences =</span> np1) +
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Post-warmup Iteration&quot;</span>)</code></pre></div>
<p><img src="bayesplot_files/figure-html/mcmc_trace-1.png" width="672" /></p>
<p>To look deeper at the information conveyed by the divergences we can use the <code>mcmc_nuts_divergence</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">color_scheme_set</span>(<span class="st">&quot;red&quot;</span>)
<span class="kw">mcmc_nuts_divergence</span>(np1, lp1)</code></pre></div>
<p><img src="bayesplot_files/figure-html/mcmc_nuts_divergence-1.png" width="672" /></p>
<p>In the top panel we see the distribution of the log-posterior when there was no divergence vs the distribution when there was a divergence. Divergences often indicate that some part of the posterior isn’t being explored and <code>lp|Divergence</code> will have lighter tails than <code>lp|No divergence</code>.</p>
<p>The bottom panel shows the same thing but instead of the log-posterior the NUTS acceptance statistic is shown.</p>
<p>Specifying the optional <code>chain</code> argument will overlay the plot just for a particular Markov chain on the plot for all chains combined:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_nuts_divergence</span>(np1, lp1, <span class="dt">chain =</span> <span class="dv">4</span>)</code></pre></div>
<p><img src="bayesplot_files/figure-html/mcmc_nuts_divergence-chain-1.png" width="672" /></p>
<p>For the non-centered parameterization we also had warnings about divergences</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_nuts_divergence</span>(np2, lp2)</code></pre></div>
<p><img src="bayesplot_files/figure-html/mcmc_nuts_divergence-2-1.png" width="672" /></p>
<p>but we have far fewer of them to worry about. If there are only a few divergences we can often get rid of them by increasing the target acceptance rate (<code>adapt_delta</code>), which has the effect of lowering the stepsize used by the sampler and allowing the Markov chains to explore more complicated curvature in the target distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit1b &lt;-<span class="st"> </span><span class="kw">sampling</span>(schools_mod1, <span class="dt">data =</span> schools_dat,
                  <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.99</span>))</code></pre></div>
<pre><code>## Warning: There were 69 divergent transitions after warmup. Increasing adapt_delta above 0.99 may help. See
## http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code>## Warning: There were 4 chains where the estimated Bayesian Fraction of Missing Information was low. See
## http://mc-stan.org/misc/warnings.html#bfmi-low</code></pre>
<pre><code>## Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit2b &lt;-<span class="st"> </span><span class="kw">sampling</span>(schools_mod2, <span class="dt">data =</span> schools_dat,
                  <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.99</span>))</code></pre></div>
<p>For the first model and this particular data, increasing <code>adapt_delta</code> will not solve the problem and a reparameterization is required.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_nuts_divergence</span>(<span class="kw">nuts_params</span>(fit1b), <span class="kw">log_posterior</span>(fit1b))</code></pre></div>
<p><img src="bayesplot_files/figure-html/mcmc_nuts_divergence-3-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_nuts_divergence</span>(<span class="kw">nuts_params</span>(fit2b), <span class="kw">log_posterior</span>(fit2b))</code></pre></div>
<p><img src="bayesplot_files/figure-html/mcmc_nuts_divergence-3-2.png" width="672" /></p>
</div>
<div id="energy-and-bayesian-fraction-of-missing-information" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Energy and Bayesian fraction of missing information</h3>
<p>The <code>mcmc_nuts_energy</code> function creates plots similar to those presented in Betancourt (2017). While <code>mcmcm_nuts_divergence</code> can identify light tails and incomplete exploration of the target distribution, the <code>mcmc_nuts_energy</code> function can identify overly heavy tails that are also challenging for sampling. Informally, the energy diagnostic for HMC (and the related energy-based Bayesian fraction of missing information) quantifies the heaviness of the tails of the posterior distribution.</p>
<p>The plot created by <code>mcmc_nuts_energy</code> shows overlaid histograms of the (centered) marginal energy distribution <span class="math inline">\(\pi_E\)</span> and the first-differenced distribution <span class="math inline">\(\pi_{\Delta E}\)</span>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_nuts_energy</span>(np1)</code></pre></div>
<pre><code>## Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font
## &quot;Symbol&quot; could not be found for family &quot;&quot;</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<p><img src="bayesplot_files/figure-html/mcmc_nuts_energy-1-1.png" width="672" /> To keep the chains separate add <code>merge_chains=FALSE</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_nuts_energy</span>(np1, <span class="dt">merge_chains =</span> <span class="ot">FALSE</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>## Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font
## &quot;Symbol&quot; could not be found for family &quot;&quot;</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<p><img src="bayesplot_files/figure-html/mcmc_nuts_energy-2-1.png" width="672" /></p>
<p>The two histograms ideally look the same (Betancourt, 2017), which is only the case for the non-centered parameterization (bottom panel):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">compare_cp_ncp</span>(
  <span class="kw">mcmc_nuts_energy</span>(np1, <span class="dt">binwidth =</span> <span class="dv">1</span>/<span class="dv">2</span>),
  <span class="kw">mcmc_nuts_energy</span>(np2, <span class="dt">binwidth =</span> <span class="dv">1</span>/<span class="dv">2</span>)
)</code></pre></div>
<pre><code>## Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font
## &quot;Symbol&quot; could not be found for family &quot;&quot;</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font
## &quot;Symbol&quot; could not be found for family &quot;&quot;</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<p><img src="bayesplot_files/figure-html/mcmc_nuts_energy-3-1.png" width="672" /></p>
<p>The difference between the parameterizations is even more apparent if we force the stepsize to a smaller value and help the chains explore more of the posterior:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">np1b &lt;-<span class="st"> </span><span class="kw">nuts_params</span>(fit1b)
np2b &lt;-<span class="st"> </span><span class="kw">nuts_params</span>(fit2b)
<span class="kw">compare_cp_ncp</span>(
  <span class="kw">mcmc_nuts_energy</span>(np1b),
  <span class="kw">mcmc_nuts_energy</span>(np2b)
)</code></pre></div>
<pre><code>## Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font
## &quot;Symbol&quot; could not be found for family &quot;&quot;</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font
## &quot;Symbol&quot; could not be found for family &quot;&quot;</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;

## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x
## $y, : font &quot;Symbol&quot; could not be found for family &quot;serif&quot;</code></pre>
<p><img src="bayesplot_files/figure-html/mcmc_nuts_energy-4-1.png" width="672" /></p>
<p>See Betancourt (2017) for more on this particular example as well as the general theory behind the energy plots.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plotting-mcmc-draws.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["bayesplot.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
